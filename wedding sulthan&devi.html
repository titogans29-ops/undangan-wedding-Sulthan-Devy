<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Undangan Pernikahan Sulthan & Devy</title>
    <!-- Load Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <!-- Load Phosphor Icons for elegant icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <!-- Load Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, addDoc, onSnapshot, collection, query, serverTimestamp, orderBy, limit, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // IMPORTANT: The following variables are provided by the canvas environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let db, auth;
        let userId = null;
        let isAuthReady = false;

        setLogLevel('Debug');

        try {
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
            
            // 1. Handle Authentication
            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    userId = user.uid;
                } else {
                    try {
                        if (initialAuthToken) {
                            await signInWithCustomToken(auth, initialAuthToken);
                        } else {
                            await signInAnonymously(auth);
                        }
                        userId = auth.currentUser?.uid || crypto.randomUUID();
                    } catch (error) {
                        console.error("Authentication error:", error);
                        userId = crypto.randomUUID(); // Fallback ID
                    }
                }
                document.getElementById('user-id-display').textContent = userId;
                isAuthReady = true;
                // Once authenticated, start the real-time listeners
                setupRealTimeListeners();
            });

        } catch (error) {
            console.error("Firebase Initialization Error:", error);
            // Fallback for environment where Firebase config is not provided
            isAuthReady = true;
            setupRealTimeListeners(); // Try to set up listeners even without proper auth/db to prevent errors
        }

        // --- GLOBAL DATA & FUNCTIONS ---
        window.APP_DATA = {
            db, auth, userId: () => userId, isAuthReady: () => isAuthReady, appId,
            getPublicCollectionRef: (collectionName) => {
                if (!db) return null;
                return collection(db, `artifacts/${appId}/public/data/${collectionName}`);
            }
        };

        const WEDDING_DATE = new Date('2025-10-19T08:00:00');

        // --- GUEST BOOK LOGIC ---
        function setupRealTimeListeners() {
            if (!window.APP_DATA.isAuthReady() || !db) return;

            // 1. Guest Book Listener (Ucapan)
            const ucapanRef = window.APP_DATA.getPublicCollectionRef('wedding_messages');
            if (ucapanRef) {
                const q = query(ucapanRef, orderBy("timestamp", "desc"), limit(50));
                onSnapshot(q, (snapshot) => {
                    const messagesContainer = document.getElementById('messages-container');
                    if (!messagesContainer) return;
                    messagesContainer.innerHTML = '';
                    snapshot.forEach((doc) => {
                        const data = doc.data();
                        const messageElement = `
                            <div class="bg-cream p-4 rounded-xl shadow-lg border-l-4 border-wine animate-fade-in transition duration-300 transform hover:scale-[1.01]">
                                <p class="text-lg font-semibold text-wine">${data.name || 'Tamu Anonim'}</p>
                                <p class="text-gray-700 mt-1 whitespace-pre-wrap">${data.message}</p>
                                <p class="text-xs text-gray-500 mt-2">${data.timestamp ? new Date(data.timestamp.seconds * 1000).toLocaleString('id-ID', { dateStyle: 'medium', timeStyle: 'short' }) : 'Baru saja'}</p>
                            </div>
                        `;
                        messagesContainer.insertAdjacentHTML('beforeend', messageElement);
                    });
                }, (error) => {
                    console.error("Error listening to messages:", error);
                });
            }
        }

        window.submitMessage = async (event) => {
            event.preventDefault();
            const form = event.target;
            const name = form.name.value.trim();
            const message = form.message.value.trim();
            const submitButton = form.querySelector('button[type="submit"]');

            if (!name || !message) {
                displayModal("Gagal Mengirim", "Nama dan Ucapan harus diisi.", "wine");
                return;
            }

            if (!window.APP_DATA.isAuthReady() || !db) {
                displayModal("Kesalahan Database", "Database belum siap. Coba refresh halaman.", "wine");
                return;
            }

            try {
                submitButton.disabled = true;
                submitButton.textContent = 'Mengirim...';

                const ucapanRef = window.APP_DATA.getPublicCollectionRef('wedding_messages');
                await addDoc(ucapanRef, {
                    name: name,
                    message: message,
                    timestamp: serverTimestamp(),
                    userId: window.APP_DATA.userId(),
                });

                form.reset();
                displayModal("Ucapan Terkirim!", "Terima kasih atas doa dan ucapan terbaiknya.", "wine");
            } catch (error) {
                console.error("Error submitting message:", error);
                displayModal("Gagal Mengirim", "Terjadi kesalahan saat menyimpan ucapan. Coba lagi.", "wine");
            } finally {
                submitButton.disabled = false;
                submitButton.textContent = 'Kirim Ucapan';
            }
        };

        // --- RSVP LOGIC ---
        window.submitRsvp = async (event) => {
            event.preventDefault();
            const form = event.target;
            const name = form.rsvpName.value.trim();
            const attendance = form.attendance.value;
            const submitButton = form.querySelector('button[type="submit"]');

            if (!name || !attendance) {
                displayModal("Gagal RSVP", "Nama dan status kehadiran harus diisi.", "wine");
                return;
            }

            if (!window.APP_DATA.isAuthReady() || !db) {
                displayModal("Kesalahan Database", "Database belum siap. Coba refresh halaman.", "wine");
                return;
            }

            try {
                submitButton.disabled = true;
                submitButton.textContent = 'Mengirim...';
                
                const rsvpRef = window.APP_DATA.getPublicCollectionRef('wedding_rsvps');
                await addDoc(rsvpRef, {
                    name: name,
                    attendance: attendance,
                    timestamp: serverTimestamp(),
                    userId: window.APP_DATA.userId(),
                });

                displayModal("RSVP Terkirim!", "Konfirmasi kehadiran Anda telah diterima. Sampai jumpa!", "wine");
                form.reset();
            } catch (error) {
                console.error("Error submitting RSVP:", error);
                displayModal("Gagal RSVP", "Terjadi kesalahan saat menyimpan konfirmasi. Coba lagi.", "wine");
            } finally {
                submitButton.disabled = false;
                submitButton.textContent = 'Konfirmasi Kehadiran';
            }
        };

        // --- COUNTDOWN LOGIC ---
        function updateCountdown() {
            const now = new Date().getTime();
            const distance = WEDDING_DATE - now;

            if (distance < 0) {
                document.getElementById('countdown').innerHTML = `<p class="text-3xl font-bold text-wine">Acara Sedang Berlangsung!</p>`;
                return;
            }

            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            const timerHtml = `
                <div class="flex space-x-4 justify-center">
                    ${[
                        { value: days, label: 'Hari' },
                        { value: hours, label: 'Jam' },
                        { value: minutes, label: 'Menit' },
                        { value: seconds, label: 'Detik' }
                    ].map(item => `
                        <div class="text-center bg-white/20 backdrop-blur-sm p-3 rounded-xl shadow-lg w-16 md:w-20">
                            <div class="text-3xl font-bold text-wine">${item.value.toString().padStart(2, '0')}</div>
                            <div class="text-xs uppercase mt-1 font-semibold text-wine/80">${item.label}</div>
                        </div>
                    `).join('')}
                </div>
            `;
            document.getElementById('countdown').innerHTML = timerHtml;
        }
        setInterval(updateCountdown, 1000);
        updateCountdown(); // Initial call
    </script>

    <!-- Tailwind Config with Custom Colors and Fonts -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'wine': '#800000', // Maroon / Wine Red
                        'cream': '#FFFBFB', // Soft Off-White
                    },
                    fontFamily: {
                        'script': ['"Great Vibes"', 'cursive'], // Elegant script font
                        'sans': ['Inter', 'sans-serif'], // General font
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.8s ease-out forwards',
                        'float': 'float 3s ease-in-out infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: 0, transform: 'translateY(20px)' },
                            '100%': { opacity: 1, transform: 'translateY(0)' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-5px)' },
                        }
                    }
                }
            }
        }
    </script>

    <!-- Custom Global Styles -->
    <style>
        .parallax-bg {
            background-image: url('https://lh3.googleusercontent.com/d/1ix-dXaaRmRLMff4YuVt_MmOPZ2yDZ8LJ');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .section-padding {
            padding: 4rem 1.5rem;
        }

        /* Utility for scroll animation */
        .scroll-animate {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        
        .scroll-animate.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Custom scrollbar for elegance */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #a87979; /* Soft Wine */
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #800000; /* Darker Wine */
        }

        /* Ensure Google Maps iframe is responsive */
        .map-container {
            position: relative;
            padding-bottom: 75%; /* 4:3 aspect ratio */
            height: 0;
            overflow: hidden;
            border-radius: 12px;
        }

        .map-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100% !important;
            height: 100% !important;
            border: 0;
        }
    </style>
</head>
<body class="font-sans text-gray-800 bg-cream selection:bg-wine selection:text-white">

    <!-- Audio Player (Hidden until user interaction) -->
    <audio id="background-music" loop preload="auto" src="https://www.bensound.com/bensound-music/bensound-romantic.mp3"></audio>

    <!-- Modal for Alerts (Custom replacement for alert/confirm) -->
    <div id="custom-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-xl p-6 shadow-2xl max-w-sm w-full transform transition-all duration-300 scale-95 opacity-0" id="modal-content-wrapper">
            <h3 id="modal-title" class="text-2xl font-script font-bold text-wine mb-3"></h3>
            <p id="modal-message" class="text-gray-700 mb-6"></p>
            <button onclick="closeModal()" class="w-full bg-wine text-white py-2 rounded-lg hover:bg-red-800 transition duration-300 focus:outline-none focus:ring-2 focus:ring-wine">OK</button>
        </div>
    </div>

    <!-- Music Control Button (Floating) -->
    <button id="music-toggle" class="fixed bottom-6 right-6 z-40 p-4 bg-wine text-white rounded-full shadow-xl hover:shadow-2xl transition duration-300 transform hover:scale-105 hidden" aria-label="Toggle Background Music">
        <i class="ph ph-music-notes text-xl"></i>
    </button>
    
    <!-- Invitation Opener & Hero Section -->
    <div id="hero-section" class="parallax-bg text-center text-white relative">
        <!-- Overlay for better text readability -->
        <div class="absolute inset-0 bg-black/40"></div>

        <!-- Opener Card (Visible before clicking "Buka Undangan") -->
        <div id="opener-card" class="relative z-10 bg-white/90 backdrop-blur-sm p-8 md:p-12 rounded-2xl shadow-2xl max-w-md mx-auto transform transition-all duration-700 opacity-100 scale-100">
            <p class="text-lg text-gray-700 mb-2 font-light">Kepada Yth:</p>
            <!-- Note: The guest name placeholder ({{name}}) should be filled dynamically if integrated with a link parameter -->
            <h1 class="text-3xl md:text-4xl font-semibold text-wine mb-6">Tamu Undangan</h1> 
            <p class="text-base text-gray-600 mb-8">Dengan memohon rahmat dan ridho Allah SWT, kami mengundang Bapak/Ibu/Saudara/i untuk hadir pada pernikahan kami.</p>
            <button onclick="openInvitation()" class="bg-wine text-white py-3 px-8 rounded-full shadow-lg hover:bg-red-800 transition duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-wine/50">
                <i class="ph ph-envelope-open mr-2"></i> Buka Undangan
            </button>
        </div>

        <!-- Main Hero Content (Hidden until "Buka Undangan" is clicked) -->
        <div id="hero-content" class="relative z-10 p-4 pt-16 md:p-8 opacity-0 transition-opacity duration-1000 hidden">
            <p class="text-xl md:text-2xl font-script text-cream tracking-wider" id="hero-pre-text">The Wedding of</p>
            <h1 class="text-7xl md:text-9xl font-script text-white drop-shadow-lg my-6" id="hero-names">Sulthan & Devy</h1>
            <p class="text-xl md:text-3xl font-script text-cream drop-shadow-md" id="hero-date">19 Oktober 2025</p>
        </div>

        <!-- Scroll down indicator -->
        <div id="scroll-indicator" class="absolute bottom-10 left-1/2 -translate-x-1/2 text-white/90 animate-float opacity-0 hidden transition-opacity duration-1000">
            <p class="text-sm">Scroll ke Bawah</p>
            <i class="ph ph-arrow-down text-2xl mt-1"></i>
        </div>
    </div>

    <!-- Main Content Sections (Hidden until invitation opened) -->
    <main id="main-content" class="bg-cream opacity-0 transition-opacity duration-1000 hidden">

        <!-- Countdown Section -->
        <section id="countdown-section" class="section-padding bg-wine/10 text-center scroll-animate">
            <h2 class="text-3xl md:text-4xl font-script text-wine mb-8">Menghitung Hari Bahagia</h2>
            <div id="countdown" class="max-w-xl mx-auto">
                <!-- Countdown timer will be injected here by JS -->
            </div>
            <p class="text-sm mt-8 text-gray-600">ID Pengguna Anda (Untuk Database): <span id="user-id-display" class="font-mono text-xs text-wine">Loading...</span></p>
        </section>

        <!-- Couple and Parents Section -->
        <section id="couple-section" class="section-padding text-center scroll-animate">
            <h2 class="text-3xl md:text-4xl font-script text-wine mb-12">Pasangan Pengantin</h2>
            
            <p class="text-lg mb-8 text-gray-600 max-w-xl mx-auto">
                "Dan di antara tanda-tanda kekuasaan-Nya ialah Dia menciptakan untukmu pasangan-pasangan dari jenismu sendiri, agar kamu cenderung dan merasa tenteram kepadanya, dan dijadikan-Nya di antaramu rasa kasih dan sayang. Sungguh, pada yang demikian itu benar-benar terdapat tanda-tanda (kebesaran Allah) bagi kaum yang berpikir." <br>
                <span class="font-serif italic text-sm">(QS. Ar-Rum: 21)</span>
            </p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 max-w-3xl mx-auto">
                <!-- Groom: Sulthan -->
                <div class="p-6 rounded-xl shadow-lg bg-white border-t-4 border-wine/50 transform hover:shadow-xl transition duration-300">
                    <p class="text-4xl font-script text-wine mb-4">Sulthan</p>
                    <h3 class="text-2xl font-semibold mb-2">Sulthan Aiesdiyanto</h3>
                    <p class="text-base text-gray-700">Putra dari:</p>
                    <p class="text-lg font-medium text-wine">Bapak Sunariyono & Ibu Isnaini</p>
                </div>

                <!-- Bride: Devy -->
                <div class="p-6 rounded-xl shadow-lg bg-white border-t-4 border-wine/50 transform hover:shadow-xl transition duration-300">
                    <p class="text-4xl font-script text-wine mb-4">Devy</p>
                    <h3 class="text-2xl font-semibold mb-2">Devy Ayu Meilina S.Kom</h3>
                    <p class="text-base text-gray-700">Putri dari:</p>
                    <p class="text-lg font-medium text-wine">Bapak Ayat Sukardi & Ibu Lilis</p>
                </div>
            </div>
        </section>
        
        <!-- Event Details Section -->
        <section id="event-section" class="section-padding bg-wine/10 scroll-animate">
            <h2 class="text-3xl md:text-4xl font-script text-wine text-center mb-12">Waktu & Tempat</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 max-w-5xl mx-auto">
                
                <!-- Date Card -->
                <div class="bg-wine text-white p-8 rounded-xl shadow-xl text-center lg:col-span-1 transform hover:shadow-2xl transition duration-300">
                    <i class="ph ph-calendar-blank text-5xl mb-3"></i>
                    <h3 class="text-2xl font-bold mb-1">Minggu</h3>
                    <p class="text-4xl font-script">19 Oktober 2025</p>
                </div>

                <!-- Akad Nikah Card -->
                <div class="bg-white p-8 rounded-xl shadow-xl text-center border-t-4 border-wine transform hover:shadow-2xl transition duration-300">
                    <i class="ph ph-handshake text-5xl text-wine mb-3"></i>
                    <h3 class="text-2xl font-bold text-wine mb-2">Akad Nikah</h3>
                    <p class="text-lg mb-4 text-gray-700">Pukul: 08:00 WIB</p>
                    <a href="#location-map" class="text-wine font-semibold hover:underline flex items-center justify-center">
                        <i class="ph ph-map-pin text-xl mr-2"></i> Lihat Lokasi
                    </a>
                </div>

                <!-- Resepsi Card -->
                <div class="bg-white p-8 rounded-xl shadow-xl text-center border-t-4 border-wine transform hover:shadow-2xl transition duration-300">
                    <i class="ph ph-confetti text-5xl text-wine mb-3"></i>
                    <h3 class="text-2xl font-bold text-wine mb-2">Resepsi</h3>
                    <p class="text-lg mb-4 text-gray-700">Pukul: 11:00 - Selesai WIB</p>
                    <a href="#location-map" class="text-wine font-semibold hover:underline flex items-center justify-center">
                        <i class="ph ph-map-pin text-xl mr-2"></i> Lihat Lokasi
                    </a>
                </div>
            </div>

            <!-- Location Map -->
            <div id="location-map" class="mt-12 max-w-5xl mx-auto scroll-animate">
                <h3 class="text-2xl font-semibold text-wine mb-4 text-center">Lokasi Acara</h3>
                <p class="text-center text-gray-700 mb-6">Jl. Bumi Lestari No.28, Mangunjaya, Kec. Tambun Sel., Kabupaten Bekasi, Jawa Barat 17510</p>
                
                <div class="map-container shadow-2xl">
                    <!-- Google Maps Embed for the location (using coordinates for Bekasi, Tambun Selatan area) -->
                    <iframe 
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3965.77255959954!2d107.03043837500506!3d-6.29231879369974!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2e698889151525a7%3A0xc49b77d612f00f07!2sJl.%20Bumi%20Lestari%20No.28%2C%20Mangunjaya%2C%20Kec.%20Tambun%20Sel.%2C%20Kabupaten%20Bekasi%2C%20Jawa%20Barat%2017510!5e0!3m2!1sen!2sid!4v1715876356066!5m2!1sen!2sid" 
                        allowfullscreen="" 
                        loading="lazy" 
                        referrerpolicy="no-referrer-when-downgrade"
                    ></iframe>
                </div>

                <div class="mt-8 text-center">
                    <a href="https://maps.app.goo.gl/YourMapLinkHere" target="_blank" class="inline-flex items-center bg-wine text-white py-3 px-6 rounded-full shadow-lg hover:bg-red-800 transition duration-300 transform hover:scale-105">
                        <i class="ph ph-car text-xl mr-2"></i> Buka di Google Maps
                    </a>
                </div>
            </div>
        </section>

        <!-- Gallery Section -->
        <section id="gallery-section" class="section-padding text-center scroll-animate">
            <h2 class="text-3xl md:text-4xl font-script text-wine mb-12">Galeri Foto</h2>
            
            <div class="grid grid-cols-2 md:grid-cols-3 gap-3 md:gap-4 max-w-4xl mx-auto">
                <!-- Gallery Item 1 -->
                <div class="rounded-xl overflow-hidden shadow-lg aspect-square group">
                    <img onerror="this.onerror=null; this.src='https://placehold.co/400x400/800000/FFFFFF?text=Foto+1';" src="https://lh3.googleusercontent.com/d/1gVLEJA2blBSxAkadDnqDpi1CQrnEP3Za" alt="Foto Pasangan 1" class="w-full h-full object-cover transition duration-500 transform group-hover:scale-105">
                </div>
                <!-- Gallery Item 2 -->
                <div class="rounded-xl overflow-hidden shadow-lg aspect-square group">
                    <img onerror="this.onerror=null; this.src='https://placehold.co/400x400/800000/FFFFFF?text=Foto+2';" src="https://lh3.googleusercontent.com/d/1R_T8isUvo0PLWxc48E_t9bcGWormF4Bm" alt="Foto Pasangan 2" class="w-full h-full object-cover transition duration-500 transform group-hover:scale-105">
                </div>
                <!-- Gallery Item 3 -->
                <div class="rounded-xl overflow-hidden shadow-lg aspect-square group">
                    <img onerror="this.onerror=null; this.src='https://placehold.co/400x400/800000/FFFFFF?text=Foto+3';" src="https://lh3.googleusercontent.com/d/1UHnTW60Hp6KXmYc4Orp1vpvlyy1ZkYr_" alt="Foto Pasangan 3" class="w-full h-full object-cover transition duration-500 transform group-hover:scale-105">
                </div>
                <!-- Gallery Item 4 -->
                <div class="rounded-xl overflow-hidden shadow-lg aspect-square group">
                    <img onerror="this.onerror=null; this.src='https://placehold.co/400x400/800000/FFFFFF?text=Foto+4';" src="https://lh3.googleusercontent.com/d/1HP4Nqo6ZN_6eNbFywVbG4hpS_m6gYUsg" alt="Foto Pasangan 4" class="w-full h-full object-cover transition duration-500 transform group-hover:scale-105">
                </div>
                <!-- Gallery Item 5 -->
                <div class="rounded-xl overflow-hidden shadow-lg aspect-square group">
                    <img onerror="this.onerror=null; this.src='https://placehold.co/400x400/800000/FFFFFF?text=Foto+5';" src="https://lh3.googleusercontent.com/d/15RLIttRGpr_bSGDwMdRdmy7x0HV-Kx3S" alt="Foto Pasangan 5" class="w-full h-full object-cover transition duration-500 transform group-hover:scale-105">
                </div>
                <!-- Gallery Item 6 -->
                <div class="rounded-xl overflow-hidden shadow-lg aspect-square group">
                    <img onerror="this.onerror=null; this.src='https://placehold.co/400x400/800000/FFFFFF?text=Foto+6';" src="https://lh3.googleusercontent.com/d/1JDfmCG-Ulqf1ENfISFWlKJ-6YK4z7Hjf" alt="Foto Pasangan 6" class="w-full h-full object-cover transition duration-500 transform group-hover:scale-105">
                </div>
            </div>
        </section>

        <!-- RSVP Section -->
        <section id="rsvp-section" class="section-padding bg-wine/10 scroll-animate">
            <div class="max-w-xl mx-auto p-8 bg-white rounded-xl shadow-2xl border-t-8 border-wine">
                <h2 class="text-3xl font-script text-wine text-center mb-6">Konfirmasi Kehadiran (RSVP)</h2>
                <p class="text-center text-gray-700 mb-8">Mohon konfirmasi kehadiran Anda selambat-lambatnya satu minggu sebelum acara.</p>
                
                <form id="rsvp-form" onsubmit="window.submitRsvp(event)">
                    <div class="mb-5">
                        <label for="rsvpName" class="block text-sm font-medium text-gray-700 mb-1">Nama Lengkap</label>
                        <input type="text" id="rsvpName" name="rsvpName" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-wine focus:border-wine transition duration-300">
                    </div>
                    
                    <div class="mb-8">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Kehadiran</label>
                        <div class="flex flex-col space-y-3">
                            <label class="inline-flex items-center">
                                <input type="radio" name="attendance" value="Hadir" required class="form-radio h-5 w-5 text-wine focus:ring-wine" checked>
                                <span class="ml-2 text-gray-700">Insya Allah Hadir</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="attendance" value="Tidak Hadir" required class="form-radio h-5 w-5 text-wine focus:ring-wine">
                                <span class="ml-2 text-gray-700">Mohon Maaf Tidak Hadir</span>
                            </label>
                        </div>
                    </div>
                    
                    <button type="submit" class="w-full bg-wine text-white py-3 rounded-lg font-semibold hover:bg-red-800 transition duration-300 transform hover:scale-[1.01] focus:outline-none focus:ring-4 focus:ring-wine/50">
                        Konfirmasi Kehadiran
                    </button>
                </form>
            </div>
        </section>

        <!-- Guest Book Section -->
        <section id="guestbook-section" class="section-padding text-center scroll-animate">
            <h2 class="text-3xl md:text-4xl font-script text-wine mb-6">Kolom Ucapan & Doa</h2>
            
            <p class="text-lg text-gray-700 max-w-3xl mx-auto mb-10 p-4 border-l-4 border-wine/50 bg-white/50 rounded-lg">
                "Mohon doanya agar kami dapat membangun rumah tangga yang sakinah, mawadah, dan warahmah. Silakan tuliskan ucapan terbaik Anda di bawah ini."
            </p>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 max-w-5xl mx-auto">
                <!-- Message Submission Form -->
                <div class="lg:col-span-1 p-6 bg-white rounded-xl shadow-xl border-t-4 border-wine">
                    <h3 class="text-xl font-semibold text-wine mb-4">Tulis Ucapan Anda</h3>
                    <form id="message-form" onsubmit="window.submitMessage(event)">
                        <div class="mb-4">
                            <label for="name" class="block text-left text-sm font-medium text-gray-700 mb-1">Nama Anda</label>
                            <input type="text" id="name" name="name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-wine focus:border-wine transition duration-300">
                        </div>
                        <div class="mb-6">
                            <label for="message" class="block text-left text-sm font-medium text-gray-700 mb-1">Ucapan & Doa</label>
                            <textarea id="message" name="message" rows="4" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-wine focus:border-wine transition duration-300"></textarea>
                        </div>
                        <button type="submit" class="w-full bg-wine text-white py-3 rounded-lg font-semibold hover:bg-red-800 transition duration-300 transform hover:scale-[1.01] focus:outline-none focus:ring-4 focus:ring-wine/50">
                            Kirim Ucapan
                        </button>
                    </form>
                </div>

                <!-- Messages Display -->
                <div class="lg:col-span-2 space-y-4 h-96 overflow-y-auto p-2">
                    <h3 class="text-xl font-semibold text-wine text-left mb-4">Ucapan Terbaru (<span id="message-count">Loading...</span>)</h3>
                    <div id="messages-container" class="space-y-4">
                        <p class="text-gray-500">Memuat ucapan...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer Section -->
        <footer class="bg-wine/90 text-white text-center py-8 scroll-animate">
            <p class="text-2xl font-script mb-2">Sulthan & Devy</p>
            <p class="text-sm">&copy; 2025 The Wedding. Design by Gemini. All Rights Reserved.</p>
        </footer>
    </main>

    <!-- JavaScript for Interactivity, Animations, and Parallax -->
    <script>
        const heroSection = document.getElementById('hero-section');
        const heroNames = document.getElementById('hero-names');
        const heroPreText = document.getElementById('hero-pre-text');
        const heroDate = document.getElementById('hero-date');
        const openerCard = document.getElementById('opener-card');
        const heroContent = document.getElementById('hero-content');
        const scrollIndicator = document.getElementById('scroll-indicator');
        const mainContent = document.getElementById('main-content');
        const musicToggle = document.getElementById('music-toggle');
        const backgroundMusic = document.getElementById('background-music');
        
        // --- 1. MODAL UTILITY (replacing alert/confirm) ---
        function displayModal(title, message, colorClass) {
            const modal = document.getElementById('custom-modal');
            const titleEl = document.getElementById('modal-title');
            const messageEl = document.getElementById('modal-message');
            const wrapper = document.getElementById('modal-content-wrapper');

            titleEl.textContent = title;
            messageEl.textContent = message;

            // Optional: style the title color based on the context
            titleEl.className = `text-2xl font-script font-bold mb-3 text-${colorClass}`;
            wrapper.classList.remove('scale-95', 'opacity-0');
            wrapper.classList.add('scale-100', 'opacity-100');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function closeModal() {
            const modal = document.getElementById('custom-modal');
            const wrapper = document.getElementById('modal-content-wrapper');
            wrapper.classList.remove('scale-100', 'opacity-100');
            wrapper.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                modal.classList.remove('flex');
                modal.classList.add('hidden');
            }, 300);
        }

        // --- 2. MUSIC HANDLING ---
        let isMusicPlaying = false;
        let hasInteracted = false;
        
        musicToggle.onclick = () => {
            if (isMusicPlaying) {
                backgroundMusic.pause();
                musicToggle.innerHTML = '<i class="ph ph-music-notes-simple text-xl"></i>';
                isMusicPlaying = false;
            } else {
                // Try to play, catches if unsuccessful (e.g., mobile policy)
                backgroundMusic.play().then(() => {
                    musicToggle.innerHTML = '<i class="ph ph-music-notes text-xl"></i>';
                    isMusicPlaying = true;
                }).catch(error => {
                    console.error("Music playback failed:", error);
                    // On failure, update UI to paused state
                    musicToggle.innerHTML = '<i class="ph ph-music-notes-simple text-xl"></i>';
                    isMusicPlaying = false;
                });
            }
        };

        function openInvitation() {
            // 1. Hide Opener Card and show Hero Content
            openerCard.classList.remove('opacity-100', 'scale-100');
            openerCard.classList.add('opacity-0', 'scale-90');
            
            setTimeout(() => {
                openerCard.classList.add('hidden');
                heroContent.classList.remove('hidden', 'opacity-0');
                heroContent.classList.add('opacity-100');
                scrollIndicator.classList.remove('hidden', 'opacity-0');
                scrollIndicator.classList.add('opacity-100');
                
                mainContent.classList.remove('hidden', 'opacity-0');
                mainContent.classList.add('opacity-100');

                // 2. Autoplay Music (will only work after a user interaction like this click)
                backgroundMusic.volume = 0.5; // Set volume lower
                backgroundMusic.play().then(() => {
                    isMusicPlaying = true;
                    musicToggle.innerHTML = '<i class="ph ph-music-notes text-xl"></i>';
                }).catch(error => {
                    console.log("Music play blocked by browser, user must click button to start.");
                    isMusicPlaying = false;
                    musicToggle.innerHTML = '<i class="ph ph-music-notes-simple text-xl"></i>';
                });
                
                musicToggle.classList.remove('hidden');
            }, 500); // Wait for transition to complete
        }

        // --- 3. SCROLL PARALLAX EFFECT ---
        function handleParallax() {
            const scrollY = window.scrollY;
            
            // Adjust background position for a subtle parallax feel
            heroSection.style.backgroundPositionY = `calc(50% - ${scrollY * 0.2}px)`;

            // Adjust text position slightly less for depth
            heroContent.style.transform = `translateY(${scrollY * 0.1}px)`;
            
            // Fade out hero text on scroll
            const maxScroll = window.innerHeight * 0.8;
            const opacity = Math.max(0, 1 - (scrollY / maxScroll));
            heroContent.style.opacity = opacity;
        }

        // --- 4. SCROLL ANIMATION (Intersection Observer) ---
        function setupScrollAnimations() {
            const animateElements = document.querySelectorAll('.scroll-animate');

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target); // Stop observing once visible
                    }
                });
            }, {
                threshold: 0.1, // Start animating when 10% of element is visible
                rootMargin: '0px 0px -100px 0px' // Load elements earlier
            });

            animateElements.forEach(el => observer.observe(el));
        }


        // --- 5. INITIALIZATION ON LOAD ---
        window.onload = function() {
            // Check if the invitation has been opened (e.g., if user refreshes after opening)
            // For a production app, this would use a session variable. Here, we assume initial load state.
            // If you want to bypass the opener for testing:
            // openInvitation(); 

            setupScrollAnimations();
        };
        
        // Add event listener for scroll effects after the invitation is opened
        document.addEventListener('scroll', () => {
             // Only apply parallax after the invitation is opened
             if (!openerCard.classList.contains('opacity-100')) {
                handleParallax();
             }
        });

    </script>
</body>
</html>
